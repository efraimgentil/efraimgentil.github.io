---
title: Configurando Spring MVC com anotações
author: Efraim Gentil
description: Aprenda a configurar um projeto Spring MVC com anotações para rodar no Tomcat
date:   2016-11-22 21:00:00
layout: post-template
categories: ['java' , 'spring']
keywords: java,spring,springmvc,tomcat,configuration,configuração,anotações,annotation,efraimgentil
---

<p>Hoje vamos aprender a configurar um preotjo Spring MVC utilizando apenas anotações e classes Java, nesse projeto vamos utilizar o a versão 4.X.X do Spring, utilizaremos o Maven para resolução de dependências,Tomcat como container para rodar nosso projeto e o Eclipse( estou utilizando a versão Luna ) como IDE.</p>

<p>Vamo começar criando o projeto Maven, utilize o atalho "Alt + Shift + N" e selecioner Maven Project, ou selecioner no menu File > New > Maven Project. Agora na janela de criação do projeto selecione a opção "Create a simple project ( skip archetype selection ) e clique em "Next". Para o Group Id teremos o valor "me.efraimgentil", para Artifact Id o valor "spring-annotation-example", no Packaging vamos selecionar "War" e clicar em "Finish" </p>


<p>Com o projeto criado, vamos colocar as dependencias necessárias para configurar e rodar o projeto com Spring MVC, veja as dependencias necessárias a seguir:</p>

{% highlight xml %}
<dependency>
  <groupId>javax.servlet</groupId>
  <artifactId>javax.servlet-api</artifactId>
  <version>3.1.0</version>
  <scope>provided</scope>
</dependency>

<dependency>
  <groupId>javax.servlet</groupId>
  <artifactId>jstl</artifactId>
  <version>1.2</version>
</dependency>

<dependency>
  <groupId>org.springframework</groupId>
  <artifactId>spring-webmvc</artifactId>
  <version>4.3.4.RELEASE</version>
</dependency>
{% endhighlight %}

<p>Com essas dependencias já podemos iniciar nossa configuração do Spring MVC, para iniciar vamos criar a classe SpringCofing no pacote "me.efraimgentil.springannotationexample.config", como a seguir:</p>

{% highlight java %}
package me.efraimgentil.springannotationexample.config;

import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;

@Configuration
@ComponentScan(basePackages = {"me.efraimgentil.springannotationexample"  })
public class SpringConfig {
  
}
{% endhighlight %}

<p>A classe vai ficar vazia, estamos apenas sinalizando para o Spring que pacotes queremos que ele scaneie para identificar seus componentes</p>

<p>A próxima classe que vamos criar é a SpringMvcConfig, selecione o mesmo pacote da classe anterior, como a seguir:</p>


{% highlight java %}
package me.efraimgentil.springannotationexample.config;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.EnableWebMvc;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;
import org.springframework.web.servlet.view.InternalResourceViewResolver;
import org.springframework.web.servlet.view.JstlView;

@Configuration
@EnableWebMvc
@ComponentScan(basePackages = {"me.efraimgentil.springannotationexample.controller"  })
public class SpringMvcConfig extends WebMvcConfigurerAdapter {
  
  @Bean
  public InternalResourceViewResolver viewResolver() {
    InternalResourceViewResolver viewResolver
                         = new InternalResourceViewResolver();
    viewResolver.setViewClass(JstlView.class);
    viewResolver.setPrefix("/WEB-INF/views/");
    viewResolver.setSuffix(".jsp");
    return viewResolver;
  }
  
}
{% endhighlight %}

<p>A anotação @EnableWebMvc habilita as configurações padrão do Spring MVC, e registra os componentes basicos necessários. Note o @Bean que estamos registrando InternalResourceViewResolver, precisamos dele para que o Spring MVC encontre nossas paginas JSP no caminho que especificamos, no caso "/WEB-INF/views/", então não se esqueça de criar a pasta "views" dentro do seus diretorio "WEB-INF", para esse objeto também especificamos o sufixo dos arquivos que serão considerados como views</p>

<p>Agora precisamos criar o nosso inicializador, basicamente ele funciona como nosso arquivo web.xml, veja a seguir como fica a classe WebInitializer</p>

{% highlight java %}
package me.efraimgentil.springannotationexample.config;

import org.springframework.web.servlet.support.AbstractAnnotationConfigDispatcherServletInitializer;

public class WebInitializer extends AbstractAnnotationConfigDispatcherServletInitializer {

  @Override
  protected Class<?>[] getRootConfigClasses() {
    return new Class[]{ SpringConfig.class };
  }

  @Override
  protected Class<?>[] getServletConfigClasses() {
    return new Class[]{  SpringMvcConfig.class };
  }

  @Override
  protected String[] getServletMappings() {
    return new String[]{ "/" };
  }

}
{% endhighlight %}

<p>Nossa classe WebInitializer extende a classe AbstractAnnotationConfigDispatcherServletInitializer do Spring, e me obriga a implementar 3 metodos, o primeiro "getRootConfigClasses" estou retornando as classes que possuem minha configuração do Spring por anotação, no segundo metodo especifico as classes de configuração que fazem alterações no ServletContext, no caso a classe SpringMvcConfig faz alterações e cofigurações do dispatcher padrão do Spring. E o ultimo metodo "getServletMappings" especifica o caminho do meu Servlet padrão, no caso vamos usar o raiz "/", para que toda requisição passe pelo meu Dispatcher do Spring MVC</p>

<p class="bg-warning">Note que vocẽ pode ver configurações que retornal null no metodo "getServletConfigClasses", e todas as classes de configuração no metodo "getRootConfigClasses", essa forma também funciona sem problema ( faça o teste =D )</p>